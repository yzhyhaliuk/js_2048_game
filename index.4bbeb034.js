const e=new class{constructor(e){this.board=e||this.createEmptyBoard(),this.status="idle",this.score=0,console.log(e)}moveLeft(){let e=!1;return this.board=this.board.map(t=>{let s=t.filter(e=>0!==e);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s.splice(t+1,1),e=!0);for(;s.length<4;)s.push(0);return JSON.stringify(s)!==JSON.stringify(t)&&(e=!0),s}),e&&this.addRandomTile(),this.checkGameWin(),this.checkGameOver(),e}moveRight(){let e=!1;return this.board=this.board.map(t=>{let s=t.filter(e=>0!==e);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]*=2,this.score+=s[t],s.splice(t-1,1),e=!0);for(;s.length<4;)s.unshift(0);return JSON.stringify(s)!==JSON.stringify(t)&&(e=!0),s}),e&&this.addRandomTile(),this.checkGameWin(),this.checkGameOver(),e}moveUp(){let e=!1,t=this.transpose(this.board).map(t=>{let s=t.filter(e=>0!==e);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s.splice(t+1,1),e=!0);for(;s.length<4;)s.push(0);return JSON.stringify(s)!==JSON.stringify(t)&&(e=!0),s});return this.board=this.transpose(t),e&&this.addRandomTile(),this.checkGameWin(),this.checkGameOver(),e}moveDown(){let e=!1,t=this.transpose(this.board);return t=t.map(t=>{let s=t.reverse(),r=s.filter(e=>0!==e);for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,this.score+=r[t],r.splice(t+1,1),e=!0);for(;r.length<4;)r.push(0);return JSON.stringify(r)!==JSON.stringify(s)&&(e=!0),r.reverse()}),this.board=this.transpose(t),e&&this.addRandomTile(),this.checkGameWin(),this.checkGameOver(),e}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.board=this.createEmptyBoard(),this.addRandomTile(),this.addRandomTile(),this.status="playing"}restart(){this.start()}createEmptyBoard(){return Array.from({length:4},()=>[,,,,].fill(0))}addRandomTile(){let e=[];for(let t=0;t<4;t++)for(let s=0;s<4;s++)0===this.board[t][s]&&e.push({row:t,col:s});if(e.length>0){let t=Math.floor(Math.random()*e.length),{row:s,col:r}=e[t];this.board[s][r]=.9>Math.random()?2:4}}checkGameOver(){if(!this.board.some(e=>e.includes(0))){for(let e=0;e<4;e++)for(let t=0;t<4;t++){let s=this.board[e][t];if(e>0&&s===this.board[e-1][t]||t>0&&s===this.board[e][t-1])return}this.status="lose"}}checkGameWin(){for(let e of this.board)if(e.includes(2048)){this.status="win";return}}transpose(e){return e[0].map((t,s)=>e.map(e=>e[s]))}},t=document.querySelector(".game-field"),s=document.querySelector(".game-score");function r(){let r=e.getState(),i=t.querySelectorAll(".field-cell"),a=0;r.forEach(e=>{e.forEach(e=>{let t=i[a];t.textContent=0===e?"":e,t.className="field-cell",e>0&&t.classList.add(`field-cell--${e}`),a++})}),s.textContent=e.getScore();let o=e.getStatus(),l=document.querySelector(".message-win"),n=document.querySelector(".message-lose"),h=document.querySelector(".message-start");l.classList.add("hidden"),n.classList.add("hidden"),h.classList.add("hidden"),"win"===o?l.classList.remove("hidden"):"lose"===o?n.classList.remove("hidden"):"idle"===o&&h.classList.remove("hidden")}document.querySelector(".start").addEventListener("click",()=>{"idle"!==e.getStatus()?e.restart():e.start(),r()}),document.addEventListener("keydown",t=>{let s=!1;switch(t.preventDefault(),t.key){case"ArrowLeft":s=e.moveLeft();break;case"ArrowRight":s=e.moveRight();break;case"ArrowUp":s=e.moveUp();break;case"ArrowDown":s=e.moveDown()}if(s){r();let e=document.querySelector(".start");e.classList.contains("restart")||(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart")}});
//# sourceMappingURL=index.4bbeb034.js.map
